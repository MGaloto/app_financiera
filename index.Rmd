---
title: "App Financiera"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    theme: yeti
    


---

<style>

.navbar-inverse {
    background-color: #000000;
    border-color: #5d5d5d;
}

.navbar-inverse .navbar-nav>li>a:focus {
    color: #f3f3f3;
    background-color: transparent;
}

.navbar-inverse .navbar-nav>.active>a, .navbar-inverse .navbar-nav>.active>a:hover, .navbar-inverse .navbar-nav>.active>a:focus {
    color: #ffffff;
    background-color: transparent;
}

.chart-stage-flex {
  overflow: scroll !important;
}


</style>





```{r setup, include=FALSE}

library(flexdashboard)
library(dplyr)
library(tidyverse)
library(lubridate)
library(rlang)
library(shiny)
library(DT)


fecha_hoy <- Sys.Date()
today <- as.Date(format(with_tz(fecha_hoy, tz = "America/Argentina/Buenos_Aires"), "%Y-%m-%d"))
todayhms <- format(with_tz(Sys.time(), tzone = "America/Argentina/Buenos_Aires"), "%Y-%m-%d %H:%M:%S")

source("R/etl.R")

#resultado <- read.csv("R/archivo.csv")


```





Panel General {data-orientation=rows}
=====================================

**Ultima actualizaciÃ³n `r todayhms`**



Row 
-----------------------------------------------------------------------


```{r}

brksVariacion <- quantile(resultado$Variacion, probs = seq(.05, .95, .05), na.rm = TRUE)
ramp <- colorRampPalette(c("#f52f2f", "#3bf557"))
clrsVariacion <- ramp(length(brksVariacion)+1)

datatable(
  resultado %>% 
    select(Especie, Variacion, InterAnual, DiasUltMax, TrendActual, CoefVariationPromedioAnual, TrendUltYear), 
  options = list(
    pageLength = -1,
        scrollY="100vh",
        scrollCollapse = FALSE
      )) %>% 
  formatStyle(
    'InterAnual',
    backgroundColor = styleInterval(c(0,50,100), c('#de1028','#91bd98', '#68de79','#3bf557'))
  )  %>%
  formatStyle(
    'DiasUltMax',
    background = styleColorBar(resultado$DiasUltMax, '#93badb'),
    backgroundSize = '100% 90%',
    backgroundRepeat = 'no-repeat',
    backgroundPosition = 'center'
  ) %>%
  formatStyle(
    'Variacion',
    backgroundColor = styleInterval(brksVariacion, clrsVariacion)
    ) %>%
  formatStyle(
    'TrendActual',
    backgroundColor = styleEqual(c("1 - Alza","2 - Alza Media", "3 - Neutro", "4 - Baja Media", "5 - Baja"),c('#15e854','#5cbd79', '#a39b9c','#c45260', '#de1028'))
    ) %>%
  formatStyle(
    'CoefVariationPromedioAnual',
    backgroundColor = styleInterval(c(0,50,100), c('#858f86','#91bd98', '#68de79','#3bf557'))
    )

```



